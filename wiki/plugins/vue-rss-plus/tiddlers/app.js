"use strict";const e=window.Vue;async function _(l){let s;l.startsWith("http")?s=await(await fetch(l)).text():s=l;const i=new DOMParser().parseFromString(s,"text/xml"),n=(c,v)=>{var h,t;return((t=(h=c==null?void 0:c.getElementsByTagName(v))==null?void 0:h[0])==null?void 0:t.textContent)||""},g=c=>{var v;try{return((v=new DOMParser().parseFromString(c,"text/html").querySelector("img"))==null?void 0:v.src)||""}catch{return""}},d=i.querySelector("channel")||i,w=i.querySelectorAll("item, entry"),p={title:n(d,"title"),link:n(d,"link"),description:n(d,"description"),update:E(n(d,"lastBuildDate")||n(d,"pubDate")||n(d,"updated"))||""},y=[...w].map(c=>{var x;const v=n(c,"title"),h=n(c,"link"),t=n(c,"description")||"",o=n(c,"content:encoded")||n(c,"content")||"",r=n(c,"pubDate")||n(c,"updated")||"",u=t+o,f=((x=c.querySelector("enclosure"))==null?void 0:x.getAttribute("url"))||"",m=g(o||t);return{title:v,link:h,summary:u,pubDate:r,mp3:f,src:m}});return{channel:p,items:y}}function E(l){var s=new Date(l),a=new Date,i=Math.abs(a-s)/1e3,n={年:31536e3,月:2592e3,周:604800,天:86400,小时:3600,分钟:60,秒:1},g="";for(var d in n){var w=Math.floor(i/n[d]);if(w>0){g+=w+" "+d+"前";break}}return g}const V={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},N=["id"],B=["fill"];function S(l,s){return e.openBlock(),e.createElementBlock("svg",V,[e.createElementVNode("defs",null,[e.createElementVNode("linearGradient",{id:l.idMap.vscodeIconsFileTypeRss0,x1:"30.06",x2:"225.94",y1:"30.06",y2:"225.94",gradientTransform:"matrix(.11 0 0 .11 2 2)",gradientUnits:"userSpaceOnUse"},s[0]||(s[0]=[e.createStaticVNode('<stop offset="0" stop-color="#e3702d"></stop><stop offset=".11" stop-color="#ea7d31"></stop><stop offset=".35" stop-color="#f69537"></stop><stop offset=".5" stop-color="#fb9e3a"></stop><stop offset=".7" stop-color="#ea7c31"></stop><stop offset=".89" stop-color="#de642b"></stop><stop offset="1" stop-color="#d95b29"></stop>',7)]),8,N)]),s[1]||(s[1]=e.createElementVNode("rect",{width:"28",height:"28",x:"2",y:"2",fill:"#cc5d15",rx:"6.01",ry:"6.01"},null,-1)),s[2]||(s[2]=e.createElementVNode("rect",{width:"26.91",height:"26.91",x:"2.54",y:"2.54",fill:"#f49c52",rx:"5.47",ry:"5.47"},null,-1)),e.createElementVNode("rect",{width:"25.82",height:"25.82",x:"3.1",y:"3.1",fill:"url(#"+l.idMap.vscodeIconsFileTypeRss0+")",rx:"5.14",ry:"5.14"},null,8,B),s[3]||(s[3]=e.createElementVNode("path",{fill:"#fff",d:"M6.82 6.16v3.83a15.31 15.31 0 0 1 15.3 15.3h3.83A19.14 19.14 0 0 0 6.81 6.17zm0 6.45v3.72a8.97 8.97 0 0 1 8.96 8.97h3.72A12.69 12.69 0 0 0 6.81 12.6zm2.62 7.44a2.63 2.63 0 0 0-2.63 2.62a2.63 2.63 0 0 0 2.63 2.63a2.63 2.63 0 0 0 2.63-2.63a2.63 2.63 0 0 0-2.63-2.63z"},null,-1))])}const D=e.markRaw({name:"tw-icons-rss",render:S,setup(){return{idMap:{vscodeIconsFileTypeRss0:"uicons-"+Math.random().toString(36).substr(2,10)}}}}),F=["src"],$={class:"flex-1 text-left"},L={class:"text-xs text-gray-500 group-hover:text-gray-700"},M=e.defineComponent({__name:"FeedButton",props:{feed:Object,selected:Boolean},emits:["load"],setup(l){return(s,a)=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["bg-transparent w-full flex items-center px-3 py-2 text-sm text-gray-700 rounded border-none cursor-pointer hover:bg-gray-100 transition-colors group",l.selected?"bg-blue-100 font-bold":""]),onClick:a[0]||(a[0]=i=>s.$emit("load"))},[e.createElementVNode("img",{src:l.feed.favicon,class:"size-4 rounded-full mr-1"},null,8,F),e.createElementVNode("span",$,e.toDisplayString(l.feed.name),1),e.createElementVNode("span",L,e.toDisplayString(l.feed.count),1)],2))}}),A={class:"font-semibold"},C={class:"text-sm text-gray-600"},R={__name:"ArticleCard",props:{article:Object},setup(l){return(s,a)=>(e.openBlock(),e.createElementBlock("div",{class:"bg-white p-3 mb-3 rounded shadow cursor-pointer hover:bg-blue-50",onClick:a[0]||(a[0]=i=>s.$emit("click"))},[e.createElementVNode("h3",A,e.toDisplayString(l.article.title),1),e.createElementVNode("p",C,e.toDisplayString(l.article.summary),1)]))}},T=["https://www.freecodecamp.org/news/rss/","https://dev.to/feed","https://talk.tiddlywiki.org/posts.rss"],U="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='1em'%20height='1em'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='currentColor'%20d='m12%200l10.23%206v12L12%2024L1.77%2018V6zm3.961%2017.889l.154-.02c.113-.043.22-.081.288-.19c.227-.329-.357-.462-.566-.827c-.209-.364-1.071-2.364-.418-2.924s1.359-.79%201.629-1.315c.117-.236.238-.475.269-.742c.159.132.283.255.497.262c.567.036%201.054-.658%201.307-1.315c.135-.404.244-.832.218-1.226c-.069-.76.013-1.582.62-2.087c-.599.302-1.167.69-1.845.789c-.374-.114-.75-.216-1.147-.2c-.194-.253-.456-.727-.797-.782c-.58.208-.597%201.105-.842%202.321a5.351%205.351%200%200%200-1.154-.193c-.54-.035-1.42.134-2.038.116c-.619-.018-1.836-.562-2.849-.445c-.407.05-.817.12-1.195.291c-.231.105-.565.421-.733.468c-1.69.473-4.442.453-3.879-2.102c.044-.196.056-.373-.03-.417c-.11-.055-.17.06-.234.187c-.985%202.138.764%203.514%202.752%203.52c.625-.048.324-.007.904-.118l-.015.082a1.87%201.87%200%200%200%20.865%201.718c-.27.771-.805%201.389-1.173%202.097c.138.881%201.031%202.057%201.4%202.225c.326.147%201.036.149%201.2-.089c.059-.111.02-.351-.044-.474c.277.308.651.736%201.013.942c.217.104.434.17.677.18l.31-.016c.154-.033.336-.058.44-.195c.116-.2.007-.756-.476-.796c-.483-.04-.795-.222-1.24-.882c-.365-.638.077-1.517.226-2.145c.765.123%201.535.22%202.31.222c.336-.017.67-.03%201.001-.093c.106.27.402%201.025.404%201.239c.007.601-.219%201.205-.121%201.807c.06.177.005.512.35.526l.388.018l.267-.008c.341.573.637.572%201.307.591m-7.518-1.66l-.063-.056c-.184-.198-.66-.544-.572-.865c.075-.238.213-.457.323-.683l-.004.023c-.02.282-.059.56.032.837c.278.228.663.59.918.837c-.138-.038-.4-.117-.53-.066l-.104-.026z'/%3e%3c/svg%3e",I={class:"flex h-screen bg-gradient-to-tr from-blue-50 via-white to-purple-100"},z={class:"w-64 p-4 bg-white/80 backdrop-blur-md border-r border-blue-100"},P={class:"flex items-center justify-between mb-6"},j={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},q={class:"mb-4 flex"},O={class:"flex mb-4 justify-between"},H=["disabled"],W={class:"space-y-1"},G={class:"flex-1 min-w-0"},J={class:"flex-1 overflow-y-auto p-6 bg-white/60 backdrop-blur-lg rounded-xl mx-4 shadow-lg border border-blue-50"},K={class:"w-1/2 overflow-y-auto bg-white/80 backdrop-blur-lg p-8 shadow-2xl rounded"},Q={class:"text-2xl font-bold mb-4 text-purple-700 drop-shadow"},X={class:"text-sm text-gray-500 mb-4"},Y=["innerHTML"],Z={key:1,class:"text-gray-400 text-center mt-20"},ee=e.defineComponent({__name:"RSS",setup(l){async function s(t){try{const{origin:o,hostname:r}=new URL(t),u=`${o}/favicon.ico`,f=await fetch(u);if(!f.ok)return"";const m=await f.blob();return await new Promise((x,b)=>{const k=new FileReader;k.onloadend=()=>x(k.result),k.onerror=b,k.readAsDataURL(m)})}catch{return U}}const a=e.ref(""),i=e.ref(""),n=e.ref([]),g=e.computed(()=>n.value.filter(t=>t.name.toLowerCase().includes(a.value.toLowerCase()))),d=e.ref(null),w=e.computed(()=>{const t=n.value.find(o=>o.name===d.value);return t?t.articles:[]}),p=e.ref(null);async function y(t){var r;if(!t.url)return;let o=t.url;if(window!=null&&window.electronAPI&&(o=await((r=window.electronAPI)==null?void 0:r.startFetchRSSData({url:t.url}))),!(t.articles&&t.articles.length>0))try{const{channel:u,items:f}=await _(o);t.articles=f.map((m,x)=>{var b;return{id:x,title:m.title,summary:((b=m.summary)==null?void 0:b.replace(/<[^>]+>/g,"").slice(0,100))||"",author:u.title||"",date:m.pubDate||"",content:m.summary||"",link:m.link,src:m.src,mp3:m.mp3}}),t.count=t.articles.length}catch{t.articles=[],t.count=0}}async function c(t){d.value=t;const o=n.value.find(r=>r.name===t);o&&((!o.articles||o.articles.length===0)&&await y(o),p.value=o.articles&&o.articles.length>0?o.articles[0]:null)}function v(t){p.value=t}async function h(){const t=i.value.trim();if(!t)return;let o=new URL(t).hostname;if(n.value.some(f=>f.url===t||f.name===o)){i.value="";return}const r=await s(t),u={name:o,url:t,count:0,articles:[],favicon:r};n.value.push(u),d.value=o,i.value="",await y(u),p.value=u.articles&&u.articles.length>0?u.articles[0]:null}return e.onMounted(async()=>{for(const t of T.filter(o=>o.startsWith("http"))){let o=new URL(t).hostname;n.value.push({name:o,url:t,count:0,articles:[],favicon:""})}n.value.length>0&&c(n.value[0].name),n.value.forEach(async t=>{const o=await s(t.url);t.favicon=o})}),(t,o)=>(e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("div",z,[e.createElementVNode("div",P,[e.createElementVNode("h2",j,[o[2]||(o[2]=e.createTextVNode(" Feeds ")),e.createVNode(e.unref(D),{class:"size-4"})])]),e.createElementVNode("div",q,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[0]||(o[0]=r=>a.value=r),type:"text",placeholder:"Search feeds...",class:"outline-gray-400 border w-full p-2"},null,512),[[e.vModelText,a.value]])]),e.createElementVNode("div",O,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[1]||(o[1]=r=>i.value=r),type:"text",placeholder:"Add RSS URL",class:"p-2 border outline-gray-400 placeholder:text-gray-400"},null,512),[[e.vModelText,i.value]]),e.createElementVNode("button",{class:"flex items-center",onClick:h,disabled:!i.value.trim()},o[3]||(o[3]=[e.createElementVNode("i",{class:"i-[material-symbols--add-rounded]"},null,-1),e.createTextVNode(" Add ")]),8,H)]),e.createElementVNode("div",W,[o[4]||(o[4]=e.createElementVNode("div",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 mb-2"}," My Feeds ",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,r=>(e.openBlock(),e.createElementBlock("div",{key:r.name,class:"flex items-center group gap-1"},[e.createElementVNode("div",G,[e.createVNode(M,{feed:r,selected:d.value===r.name,onLoad:u=>c(r.name)},null,8,["feed","selected","onLoad"])])]))),128))])]),e.createElementVNode("div",J,[o[5]||(o[5]=e.createElementVNode("h2",{class:"text-lg font-semibold mb-4 text-blue-700 drop-shadow"}," Articles ",-1)),e.createElementVNode("div",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,r=>(e.openBlock(),e.createBlock(R,{key:r.id,article:r,onClick:u=>v(r)},null,8,["article","onClick"]))),128))])]),e.createElementVNode("div",K,[p.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h2",Q,e.toDisplayString(p.value.title),1),e.createElementVNode("p",X,e.toDisplayString(p.value.author)+", "+e.toDisplayString(p.value.date),1),e.createElementVNode("p",{innerHTML:p.value.content,class:"prose max-w-none"},null,8,Y)],64)):(e.openBlock(),e.createElementBlock("div",Z,"暂无文章"))])]))}}),te={class:"vue-rss-plus-plugin"},oe=e.defineComponent({__name:"App",props:{title:{},theme:{},showLogos:{type:Boolean}},setup(l){return(s,a)=>(e.openBlock(),e.createElementBlock("div",te,[e.createVNode(ee)]))}});function ne(l={}){return function(s={}){const a={...l,...s};return{render(){return e.h(oe,a)}}}}module.exports=ne;
