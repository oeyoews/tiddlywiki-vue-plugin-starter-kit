"use strict";const e=window.Vue;async function N(r){let t;r.startsWith("http")?t=await(await fetch(r)).text():t=r;const u=new DOMParser().parseFromString(t,"text/xml"),s=(l,m)=>{var f,h;return((h=(f=l==null?void 0:l.getElementsByTagName(m))==null?void 0:f[0])==null?void 0:h.textContent)||""},p=l=>{var m;try{return((m=new DOMParser().parseFromString(l,"text/html").querySelector("img"))==null?void 0:m.src)||""}catch{return""}},c=u.querySelector("channel")||u,g=u.querySelectorAll("item, entry"),x={title:s(c,"title"),link:s(c,"link"),description:s(c,"description"),update:b(s(c,"lastBuildDate")||s(c,"pubDate")||s(c,"updated"))||""},V=[...g].map(l=>{var d;const m=s(l,"title"),f=s(l,"link"),h=s(l,"description")||"",y=s(l,"content:encoded")||s(l,"content")||"",E=s(l,"pubDate")||s(l,"updated")||"",n=h+y,o=((d=l.querySelector("enclosure"))==null?void 0:d.getAttribute("url"))||"",a=p(y||h);return{title:m,link:f,summary:n,pubDate:E,mp3:o,src:a}});return{channel:x,items:V}}function b(r){var t=new Date(r),i=new Date,u=Math.abs(i-t)/1e3,s={年:31536e3,月:2592e3,周:604800,天:86400,小时:3600,分钟:60,秒:1},p="";for(var c in s){var g=Math.floor(u/s[c]);if(g>0){p+=g+" "+c+"前";break}}return p}const B={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},C=["id"],T=["fill"];function $(r,t){return e.openBlock(),e.createElementBlock("svg",B,[e.createElementVNode("defs",null,[e.createElementVNode("linearGradient",{id:r.idMap.vscodeIconsFileTypeRss0,x1:"30.06",x2:"225.94",y1:"30.06",y2:"225.94",gradientTransform:"matrix(.11 0 0 .11 2 2)",gradientUnits:"userSpaceOnUse"},t[0]||(t[0]=[e.createStaticVNode('<stop offset="0" stop-color="#e3702d"></stop><stop offset=".11" stop-color="#ea7d31"></stop><stop offset=".35" stop-color="#f69537"></stop><stop offset=".5" stop-color="#fb9e3a"></stop><stop offset=".7" stop-color="#ea7c31"></stop><stop offset=".89" stop-color="#de642b"></stop><stop offset="1" stop-color="#d95b29"></stop>',7)]),8,C)]),t[1]||(t[1]=e.createElementVNode("rect",{width:"28",height:"28",x:"2",y:"2",fill:"#cc5d15",rx:"6.01",ry:"6.01"},null,-1)),t[2]||(t[2]=e.createElementVNode("rect",{width:"26.91",height:"26.91",x:"2.54",y:"2.54",fill:"#f49c52",rx:"5.47",ry:"5.47"},null,-1)),e.createElementVNode("rect",{width:"25.82",height:"25.82",x:"3.1",y:"3.1",fill:"url(#"+r.idMap.vscodeIconsFileTypeRss0+")",rx:"5.14",ry:"5.14"},null,8,T),t[3]||(t[3]=e.createElementVNode("path",{fill:"#fff",d:"M6.82 6.16v3.83a15.31 15.31 0 0 1 15.3 15.3h3.83A19.14 19.14 0 0 0 6.81 6.17zm0 6.45v3.72a8.97 8.97 0 0 1 8.96 8.97h3.72A12.69 12.69 0 0 0 6.81 12.6zm2.62 7.44a2.63 2.63 0 0 0-2.63 2.62a2.63 2.63 0 0 0 2.63 2.63a2.63 2.63 0 0 0 2.63-2.63a2.63 2.63 0 0 0-2.63-2.63z"},null,-1))])}const S=e.markRaw({name:"tw-icons-rss",render:$,setup(){return{idMap:{vscodeIconsFileTypeRss0:"uicons-"+Math.random().toString(36).substr(2,10)}}}}),M={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function D(r,t){return e.openBlock(),e.createElementBlock("svg",M,t[0]||(t[0]=[e.createElementVNode("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M16.25 21v-4.765a1.59 1.59 0 0 0-1.594-1.588H9.344a1.59 1.59 0 0 0-1.594 1.588V21m8.5-17.715v2.362a1.59 1.59 0 0 1-1.594 1.588H9.344A1.59 1.59 0 0 1 7.75 5.647V3m8.5.285A3.2 3.2 0 0 0 14.93 3H7.75m8.5.285c.344.156.661.374.934.645l2.382 2.375A3.17 3.17 0 0 1 20.5 8.55v9.272A3.18 3.18 0 0 1 17.313 21H6.688A3.18 3.18 0 0 1 3.5 17.823V6.176A3.18 3.18 0 0 1 6.688 3H7.75"},null,-1)]))}const z=e.markRaw({name:"tw-icons-save",render:D}),A={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function R(r,t){return e.openBlock(),e.createElementBlock("svg",A,t[0]||(t[0]=[e.createElementVNode("g",{fill:"none"},[e.createElementVNode("path",{stroke:"currentColor","stroke-linecap":"round","stroke-width":"1.5",d:"M14 22h-4c-3.771 0-5.657 0-6.828-1.172S2 17.771 2 14v-2c0-3.771 0-5.657 1.172-6.828S6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172S22 8.229 22 12v2c0 3.771 0 5.657-1.172 6.828c-.653.654-1.528.943-2.828 1.07M7 4V2.5M17 4V2.5M21.5 9H10.75M2 9h3.875"}),e.createElementVNode("path",{fill:"currentColor",d:"M18 17a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0-4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m-5 4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0-4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m-5 4a1 1 0 1 1-2 0a1 1 0 0 1 2 0m0-4a1 1 0 1 1-2 0a1 1 0 0 1 2 0"})],-1)]))}e.markRaw({name:"tw-icons-calendar",render:R});const F={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function q(r,t){return e.openBlock(),e.createElementBlock("svg",F,t[0]||(t[0]=[e.createElementVNode("path",{fill:"currentColor",d:"M11 17H7q-2.075 0-3.537-1.463T2 12t1.463-3.537T7 7h4v2H7q-1.25 0-2.125.875T4 12t.875 2.125T7 15h4zm-3-4v-2h8v2zm5 4v-2h4q1.25 0 2.125-.875T20 12t-.875-2.125T17 9h-4V7h4q2.075 0 3.538 1.463T22 12t-1.463 3.538T17 17z"},null,-1)]))}const L=e.markRaw({name:"tw-icons-link",render:q}),H={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function U(r,t){return e.openBlock(),e.createElementBlock("svg",H,t[0]||(t[0]=[e.createElementVNode("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h6q.425 0 .713.288T12 4t-.288.713T11 5H5v14h6q.425 0 .713.288T12 20t-.288.713T11 21zm12.175-8H10q-.425 0-.712-.288T9 12t.288-.712T10 11h7.175L15.3 9.125q-.275-.275-.275-.675t.275-.7t.7-.313t.725.288L20.3 11.3q.3.3.3.7t-.3.7l-3.575 3.575q-.3.3-.712.288t-.713-.313q-.275-.3-.262-.712t.287-.688z"},null,-1)]))}const I=e.markRaw({name:"tw-icons-logout",render:U}),O={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function j(r,t){return e.openBlock(),e.createElementBlock("svg",O,t[0]||(t[0]=[e.createElementVNode("g",{fill:"currentColor"},[e.createElementVNode("path",{d:"M8 6.983a1 1 0 1 0 0 2h8a1 1 0 1 0 0-2zM7 12a1 1 0 0 1 1-1h8a1 1 0 1 1 0 2H8a1 1 0 0 1-1-1m1 3.017a1 1 0 1 0 0 2h8a1 1 0 1 0 0-2z"}),e.createElementVNode("path",{"fill-rule":"evenodd",d:"M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12S6.477 2 12 2s10 4.477 10 10m-2 0a8 8 0 1 1-16 0a8 8 0 0 1 16 0","clip-rule":"evenodd"})],-1)]))}const P=e.markRaw({name:"tw-icons-menu",render:j}),G={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function W(r,t){return e.openBlock(),e.createElementBlock("svg",G,t[0]||(t[0]=[e.createElementVNode("path",{fill:"currentColor",d:"M12 4a4 4 0 0 1 4 4a4 4 0 0 1-4 4a4 4 0 0 1-4-4a4 4 0 0 1 4-4m0 2a2 2 0 0 0-2 2a2 2 0 0 0 2 2a2 2 0 0 0 2-2a2 2 0 0 0-2-2m0 7c2.67 0 8 1.33 8 4v3H4v-3c0-2.67 5.33-4 8-4m0 1.9c-2.97 0-6.1 1.46-6.1 2.1v1.1h12.2V17c0-.64-3.13-2.1-6.1-2.1"},null,-1)]))}e.markRaw({name:"tw-icons-user",render:W});const J={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function K(r,t){return e.openBlock(),e.createElementBlock("svg",J,t[0]||(t[0]=[e.createElementVNode("path",{fill:"currentColor",d:"M18 12.998h-5v5a1 1 0 0 1-2 0v-5H6a1 1 0 0 1 0-2h5v-5a1 1 0 0 1 2 0v5h5a1 1 0 0 1 0 2"},null,-1)]))}const Q=e.markRaw({name:"tw-icons-plus",render:K}),X=["src"],Y={class:"flex-1 text-eft"},Z=e.defineComponent({__name:"FeedButton",props:{feed:Object,selected:Boolean},emits:["load"],setup(r){return(t,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["w-full px-1 flex items-center py-2 text-sm text-gray-700 rounded border-none cursor-pointer hover:bg-gray-100 transition-colors group",r.selected?"bg-blue-100 font-bold":""]),onClick:i[0]||(i[0]=u=>t.$emit("load"))},[e.createElementVNode("img",{src:r.feed.favicon,class:"size-3 rounded-full mr-1"},null,8,X),e.createElementVNode("span",Y,[e.createTextVNode(e.toDisplayString(r.feed.name)+" ",1),e.withDirectives(e.createElementVNode("span",{class:"text-xs text-gray-500 group-hover:text-gray-700 italic"}," ("+e.toDisplayString(r.feed.count)+") ",513),[[e.vShow,r.feed.count>0]])])],2))}}),ee={class:"font-semibold mb-0"},te={class:"text-sm my-1 text-gray-600"},oe={__name:"ArticleCard",props:{article:Object},setup(r){return(t,i)=>(e.openBlock(),e.createElementBlock("div",{class:"bg-white p-2 mb-2 rounded shadow cursor-pointer hover:bg-blue-50",onClick:i[0]||(i[0]=u=>t.$emit("click"))},[e.createElementVNode("h3",ee,e.toDisplayString(r.article.title),1),e.createElementVNode("p",te,e.toDisplayString(r.article.summary),1)]))}},ne=["https://www.freecodecamp.org/news/rss/","https://dev.to/feed","https://talk.tiddlywiki.org/posts.rss"],re="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='1em'%20height='1em'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='currentColor'%20d='m12%200l10.23%206v12L12%2024L1.77%2018V6zm3.961%2017.889l.154-.02c.113-.043.22-.081.288-.19c.227-.329-.357-.462-.566-.827c-.209-.364-1.071-2.364-.418-2.924s1.359-.79%201.629-1.315c.117-.236.238-.475.269-.742c.159.132.283.255.497.262c.567.036%201.054-.658%201.307-1.315c.135-.404.244-.832.218-1.226c-.069-.76.013-1.582.62-2.087c-.599.302-1.167.69-1.845.789c-.374-.114-.75-.216-1.147-.2c-.194-.253-.456-.727-.797-.782c-.58.208-.597%201.105-.842%202.321a5.351%205.351%200%200%200-1.154-.193c-.54-.035-1.42.134-2.038.116c-.619-.018-1.836-.562-2.849-.445c-.407.05-.817.12-1.195.291c-.231.105-.565.421-.733.468c-1.69.473-4.442.453-3.879-2.102c.044-.196.056-.373-.03-.417c-.11-.055-.17.06-.234.187c-.985%202.138.764%203.514%202.752%203.52c.625-.048.324-.007.904-.118l-.015.082a1.87%201.87%200%200%200%20.865%201.718c-.27.771-.805%201.389-1.173%202.097c.138.881%201.031%202.057%201.4%202.225c.326.147%201.036.149%201.2-.089c.059-.111.02-.351-.044-.474c.277.308.651.736%201.013.942c.217.104.434.17.677.18l.31-.016c.154-.033.336-.058.44-.195c.116-.2.007-.756-.476-.796c-.483-.04-.795-.222-1.24-.882c-.365-.638.077-1.517.226-2.145c.765.123%201.535.22%202.31.222c.336-.017.67-.03%201.001-.093c.106.27.402%201.025.404%201.239c.007.601-.219%201.205-.121%201.807c.06.177.005.512.35.526l.388.018l.267-.008c.341.573.637.572%201.307.591m-7.518-1.66l-.063-.056c-.184-.198-.66-.544-.572-.865c.075-.238.213-.457.323-.683l-.004.023c-.02.282-.059.56.032.837c.278.228.663.59.918.837c-.138-.038-.4-.117-.53-.066l-.104-.026z'/%3e%3c/svg%3e",le={class:"flex h-screen"},se={class:"p-4",key:"sidebar"},ae={class:"flex items-center justify-between mb-6"},ce={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},ie={class:"mb-4 flex"},de={class:"flex mb-4 justify-between items-center"},ue={class:"flex items-center bg-gray-300 ml-1 rounded-sm cursor-pointer"},me={class:"space-y-1"},pe={class:"flex-1"},ve={class:"bottom-1 absolute"},fe={class:"overflow-y-auto p-4 w-2/7 custom-scrollbar"},he={key:"skeleton"},we={key:"article"},ge={class:"text-xl font-bold mb-4 -sticky py-1 top-0 z-10"},xe={class:"flex items-center gap-2 mb-8 text-sm text-gray-500 justify-end"},ke={class:"flex items-center gap-1 text-green-400 cursor-pointer"},ye=["href"],Ve={class:"text-sm text-gray-500 mb-4"},Ee=["innerHTML"],_e={key:"empty"},Ne=e.defineComponent({__name:"RSS",setup(r){const t=()=>$tw.wiki.deleteTiddler("$:/layout");async function i(n){try{const{origin:o}=new URL(n),a=`${o}/favicon.ico`,d=await fetch(a);if(!d.ok)return"";const k=await d.blob();return await new Promise((v,_)=>{const w=new FileReader;w.onloadend=()=>v(w.result),w.onerror=_,w.readAsDataURL(k)})}catch{return re}}const u=e.ref(""),s=e.ref(""),p=e.ref(!0),c=e.ref([]),g=e.computed(()=>c.value.filter(n=>n.name.toLowerCase().includes(u.value.toLowerCase()))),x=e.ref(null),V=e.computed(()=>{const n=c.value.find(o=>o.name===x.value);return n?n.articles:[]}),l=e.ref(null),m=e.ref(!1);async function f(n){var a;if(!n.url)return;let o=n.url;if(window!=null&&window.electronAPI&&(o=await((a=window.electronAPI)==null?void 0:a.startFetchRSSData({url:n.url}))),!(n.articles&&n.articles.length>0))try{const{channel:d,items:k}=await N(o);n.articles=k.map((v,_)=>{var w;return{id:_,title:v.title,summary:((w=v.summary)==null?void 0:w.replace(/<[^>]+>/g,"").slice(0,100))||"",author:d.title||"",date:v.pubDate||"",content:v.summary||"",link:v.link,src:v.src,mp3:v.mp3}}),n.count=n.articles.length}catch{n.articles=[],n.count=0}}async function h(n){x.value=n;const o=c.value.find(a=>a.name===n);o&&((!o.articles||o.articles.length===0)&&await f(o),l.value=o.articles&&o.articles.length>0?o.articles[0]:null)}function y(n){m.value=!0,setTimeout(()=>{l.value=n,m.value=!1},100)}async function E(){const n=s.value.trim();if(!n)return;let o=new URL(n).hostname;if(c.value.some(k=>k.url===n||k.name===o)){s.value="";return}const a=await i(n),d={name:o,url:n,count:0,articles:[],favicon:a};c.value.push(d),x.value=o,s.value="",await f(d),l.value=d.articles&&d.articles.length>0?d.articles[0]:null}return e.onMounted(async()=>{for(const n of ne.filter(o=>o.startsWith("http"))){let o=new URL(n).hostname;c.value.push({name:o,url:n,count:0,articles:[],favicon:""})}c.value.length>0&&h(c.value[0].name),c.value.forEach(async n=>{const o=await i(n.url);n.favicon=o})}),(n,o)=>(e.openBlock(),e.createElementBlock("div",le,[e.createVNode(P,{class:"cursor-pointer absolute top-6 right-6 z-20 rounded-full text-gray-800 backdrop-blur p-1 size-6 shadow",onClick:o[0]||(o[0]=a=>p.value=!p.value)}),e.createVNode(e.Transition,{name:"sidebar-slide"},{default:e.withCtx(()=>[e.withDirectives(e.createElementVNode("div",se,[e.createElementVNode("div",ae,[e.createElementVNode("h2",ce,[o[3]||(o[3]=e.createTextVNode(" Feeds ")),e.createVNode(S,{class:"size-4"})])]),e.createElementVNode("div",ie,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[1]||(o[1]=a=>u.value=a),type:"text",placeholder:"Search feeds...",class:"outline-gray-400 border w-full p-2"},null,512),[[e.vModelText,u.value]])]),e.createElementVNode("div",de,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[2]||(o[2]=a=>s.value=a),type:"text",placeholder:"Add RSS URL",class:"p-2 border outline-gray-400 placeholder:text-gray-400"},null,512),[[e.vModelText,s.value]]),e.createElementVNode("div",ue,[e.createVNode(Q,{onClick:E})])]),e.createElementVNode("div",me,[o[4]||(o[4]=e.createElementVNode("div",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2"}," My Feeds ",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,a=>(e.openBlock(),e.createElementBlock("div",{key:a.name,class:"flex items-center group gap-1"},[e.createElementVNode("div",pe,[e.createVNode(Z,{feed:a,selected:x.value===a.name,onLoad:d=>h(a.name)},null,8,["feed","selected","onLoad"])])]))),128)),e.createElementVNode("div",ve,[e.createVNode(I,{class:"cursor-pointer text-gray-500 size-4",onClick:t})])])],512),[[e.vShow,p.value]])]),_:1}),e.createElementVNode("div",fe,[o[5]||(o[5]=e.createElementVNode("h2",{class:"text-lg mb-3 font-semibold"},"Articles",-1)),e.createVNode(e.TransitionGroup,{name:"fade",tag:"div"},{default:e.withCtx(()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(V.value,a=>(e.openBlock(),e.createBlock(oe,{key:a.id,article:a,onClick:d=>y(a)},null,8,["article","onClick"]))),128))]),_:1})]),e.createElementVNode("div",{class:e.normalizeClass(["overflow-y-auto p-4 pt-0 overflow-x-hidden custom-scrollbar",[p.value?"w-4/7":"flex-1"]])},[e.createVNode(e.Transition,{name:"fade",mode:"out-in"},{default:e.withCtx(()=>[m.value?(e.openBlock(),e.createElementBlock("div",he)):l.value?(e.openBlock(),e.createElementBlock("div",we,[e.createElementVNode("h3",ge,e.toDisplayString(l.value.title),1),e.createElementVNode("div",xe,[e.createElementVNode("div",ke,[e.createVNode(z,{class:"size-3"}),o[6]||(o[6]=e.createTextVNode(" Save "))]),o[8]||(o[8]=e.createElementVNode("div",{class:"h-3 w-0.5 bg-slate-300/80 rounded-full"},null,-1)),e.createElementVNode("div",null,[l.value.link?(e.openBlock(),e.createElementBlock("a",{key:0,href:l.value.link,target:"_blank",class:"flex items-center gap-1 text-orange-500 hover:text-orange-600 no-underline"},[e.createVNode(L,{class:"size-4"}),o[7]||(o[7]=e.createTextVNode(" Original "))],8,ye)):e.createCommentVNode("",!0)])]),e.createElementVNode("p",Ve,e.toDisplayString(l.value.author)+", "+e.toDisplayString(l.value.date),1),e.createElementVNode("p",{innerHTML:l.value.content,class:"prose max-w-none"},null,8,Ee)])):(e.openBlock(),e.createElementBlock("div",_e,o[9]||(o[9]=[e.createElementVNode("div",{class:"text-gray-400 text-center mt-20"},"暂无文章",-1)])))]),_:1})],2)]))}}),be=(r,t)=>{const i=r.__vccOpts||r;for(const[u,s]of t)i[u]=s;return i},Be=be(Ne,[["__scopeId","data-v-9bdff95b"]]),Ce={class:"vue-rss-plus-plugin"},Te=e.defineComponent({__name:"App",props:{title:{},theme:{},showLogos:{type:Boolean}},setup(r){return(t,i)=>(e.openBlock(),e.createElementBlock("div",Ce,[e.createVNode(Be)]))}});function $e(r={}){return function(t={}){const i={...r,...t};return{render(){return e.h(Te,i)}}}}module.exports=$e;
