"use strict";const e=window.Vue;async function E(l){let n;l.startsWith("http")?n=await(await fetch(l)).text():n=l;const m=new DOMParser().parseFromString(n,"text/xml"),r=(c,h)=>{var w,x;return((x=(w=c==null?void 0:c.getElementsByTagName(h))==null?void 0:w[0])==null?void 0:x.textContent)||""},i=c=>{var h;try{return((h=new DOMParser().parseFromString(c,"text/html").querySelector("img"))==null?void 0:h.src)||""}catch{return""}},p=m.querySelector("channel")||m,v=m.querySelectorAll("item, entry"),k={title:r(p,"title"),link:r(p,"link"),description:r(p,"description"),update:V(r(p,"lastBuildDate")||r(p,"pubDate")||r(p,"updated"))||""},f=[...v].map(c=>{var u;const h=r(c,"title"),w=r(c,"link"),x=r(c,"description")||"",o=r(c,"content:encoded")||r(c,"content")||"",t=r(c,"pubDate")||r(c,"updated")||"",s=x+o,d=((u=c.querySelector("enclosure"))==null?void 0:u.getAttribute("url"))||"",g=i(o||x);return{title:h,link:w,summary:s,pubDate:t,mp3:d,src:g}});return{channel:k,items:f}}function V(l){var n=new Date(l),a=new Date,m=Math.abs(a-n)/1e3,r={年:31536e3,月:2592e3,周:604800,天:86400,小时:3600,分钟:60,秒:1},i="";for(var p in r){var v=Math.floor(m/r[p]);if(v>0){i+=v+" "+p+"前";break}}return i}const N={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},B=["id"],S=["fill"];function T(l,n){return e.openBlock(),e.createElementBlock("svg",N,[e.createElementVNode("defs",null,[e.createElementVNode("linearGradient",{id:l.idMap.vscodeIconsFileTypeRss0,x1:"30.06",x2:"225.94",y1:"30.06",y2:"225.94",gradientTransform:"matrix(.11 0 0 .11 2 2)",gradientUnits:"userSpaceOnUse"},n[0]||(n[0]=[e.createStaticVNode('<stop offset="0" stop-color="#e3702d"></stop><stop offset=".11" stop-color="#ea7d31"></stop><stop offset=".35" stop-color="#f69537"></stop><stop offset=".5" stop-color="#fb9e3a"></stop><stop offset=".7" stop-color="#ea7c31"></stop><stop offset=".89" stop-color="#de642b"></stop><stop offset="1" stop-color="#d95b29"></stop>',7)]),8,B)]),n[1]||(n[1]=e.createElementVNode("rect",{width:"28",height:"28",x:"2",y:"2",fill:"#cc5d15",rx:"6.01",ry:"6.01"},null,-1)),n[2]||(n[2]=e.createElementVNode("rect",{width:"26.91",height:"26.91",x:"2.54",y:"2.54",fill:"#f49c52",rx:"5.47",ry:"5.47"},null,-1)),e.createElementVNode("rect",{width:"25.82",height:"25.82",x:"3.1",y:"3.1",fill:"url(#"+l.idMap.vscodeIconsFileTypeRss0+")",rx:"5.14",ry:"5.14"},null,8,S),n[3]||(n[3]=e.createElementVNode("path",{fill:"#fff",d:"M6.82 6.16v3.83a15.31 15.31 0 0 1 15.3 15.3h3.83A19.14 19.14 0 0 0 6.81 6.17zm0 6.45v3.72a8.97 8.97 0 0 1 8.96 8.97h3.72A12.69 12.69 0 0 0 6.81 12.6zm2.62 7.44a2.63 2.63 0 0 0-2.63 2.62a2.63 2.63 0 0 0 2.63 2.63a2.63 2.63 0 0 0 2.63-2.63a2.63 2.63 0 0 0-2.63-2.63z"},null,-1))])}const $=e.markRaw({name:"tw-icons-rss",render:T,setup(){return{idMap:{vscodeIconsFileTypeRss0:"uicons-"+Math.random().toString(36).substr(2,10)}}}}),D={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"};function F(l,n){return e.openBlock(),e.createElementBlock("svg",D,n[0]||(n[0]=[e.createElementVNode("path",{fill:"currentColor",d:"M5 21q-.825 0-1.412-.587T3 19V5q0-.825.588-1.412T5 3h6q.425 0 .713.288T12 4t-.288.713T11 5H5v14h6q.425 0 .713.288T12 20t-.288.713T11 21zm12.175-8H10q-.425 0-.712-.288T9 12t.288-.712T10 11h7.175L15.3 9.125q-.275-.275-.275-.675t.275-.7t.7-.313t.725.288L20.3 11.3q.3.3.3.7t-.3.7l-3.575 3.575q-.3.3-.712.288t-.713-.313q-.275-.3-.262-.712t.287-.688z"},null,-1)]))}const L=e.markRaw({name:"tw-icons-logout",render:F}),C=["src"],M={class:"flex-1 text-left"},A={class:"text-xs text-gray-500 group-hover:text-gray-700"},R=e.defineComponent({__name:"FeedButton",props:{feed:Object,selected:Boolean},emits:["load"],setup(l){return(n,a)=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["bg-transparent w-full flex items-center px-3 py-2 text-sm text-gray-700 rounded border-none cursor-pointer hover:bg-gray-100 transition-colors group",l.selected?"bg-blue-100 font-bold":""]),onClick:a[0]||(a[0]=m=>n.$emit("load"))},[e.createElementVNode("img",{src:l.feed.favicon,class:"size-4 rounded-full mr-1"},null,8,C),e.createElementVNode("span",M,e.toDisplayString(l.feed.name),1),e.createElementVNode("span",A,e.toDisplayString(l.feed.count),1)],2))}}),q={class:"font-semibold"},U={class:"text-sm text-gray-600"},I={__name:"ArticleCard",props:{article:Object},setup(l){return(n,a)=>(e.openBlock(),e.createElementBlock("div",{class:"bg-white p-3 mb-3 rounded shadow cursor-pointer hover:bg-blue-50",onClick:a[0]||(a[0]=m=>n.$emit("click"))},[e.createElementVNode("h3",q,e.toDisplayString(l.article.title),1),e.createElementVNode("p",U,e.toDisplayString(l.article.summary),1)]))}},z=["https://www.freecodecamp.org/news/rss/","https://dev.to/feed","https://talk.tiddlywiki.org/posts.rss"],P="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='1em'%20height='1em'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='currentColor'%20d='m12%200l10.23%206v12L12%2024L1.77%2018V6zm3.961%2017.889l.154-.02c.113-.043.22-.081.288-.19c.227-.329-.357-.462-.566-.827c-.209-.364-1.071-2.364-.418-2.924s1.359-.79%201.629-1.315c.117-.236.238-.475.269-.742c.159.132.283.255.497.262c.567.036%201.054-.658%201.307-1.315c.135-.404.244-.832.218-1.226c-.069-.76.013-1.582.62-2.087c-.599.302-1.167.69-1.845.789c-.374-.114-.75-.216-1.147-.2c-.194-.253-.456-.727-.797-.782c-.58.208-.597%201.105-.842%202.321a5.351%205.351%200%200%200-1.154-.193c-.54-.035-1.42.134-2.038.116c-.619-.018-1.836-.562-2.849-.445c-.407.05-.817.12-1.195.291c-.231.105-.565.421-.733.468c-1.69.473-4.442.453-3.879-2.102c.044-.196.056-.373-.03-.417c-.11-.055-.17.06-.234.187c-.985%202.138.764%203.514%202.752%203.52c.625-.048.324-.007.904-.118l-.015.082a1.87%201.87%200%200%200%20.865%201.718c-.27.771-.805%201.389-1.173%202.097c.138.881%201.031%202.057%201.4%202.225c.326.147%201.036.149%201.2-.089c.059-.111.02-.351-.044-.474c.277.308.651.736%201.013.942c.217.104.434.17.677.18l.31-.016c.154-.033.336-.058.44-.195c.116-.2.007-.756-.476-.796c-.483-.04-.795-.222-1.24-.882c-.365-.638.077-1.517.226-2.145c.765.123%201.535.22%202.31.222c.336-.017.67-.03%201.001-.093c.106.27.402%201.025.404%201.239c.007.601-.219%201.205-.121%201.807c.06.177.005.512.35.526l.388.018l.267-.008c.341.573.637.572%201.307.591m-7.518-1.66l-.063-.056c-.184-.198-.66-.544-.572-.865c.075-.238.213-.457.323-.683l-.004.023c-.02.282-.059.56.032.837c.278.228.663.59.918.837c-.138-.038-.4-.117-.53-.066l-.104-.026z'/%3e%3c/svg%3e",j={class:"flex h-screen bg-gradient-to-tr from-blue-50 via-white to-purple-100"},H={class:"w-64 p-4 bg-white/80 backdrop-blur-md border-r border-blue-100"},O={class:"flex items-center justify-between mb-6"},W={class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},G={class:"mb-4 flex"},J={class:"flex mb-4 justify-between"},K=["disabled"],Q={class:"space-y-1"},X={class:"flex-1 min-w-0"},Y={class:"bottom-1 absolute"},Z={class:"flex-1 overflow-y-auto p-6 bg-white/60 backdrop-blur-lg rounded-xl mx-4 shadow-lg border border-blue-50"},ee={class:"w-1/2 overflow-y-auto bg-white/80 backdrop-blur-lg p-8 shadow-2xl rounded"},te={class:"text-2xl font-bold mb-4 text-purple-700 drop-shadow"},oe={class:"text-sm text-gray-500 mb-4"},ne=["innerHTML"],re={key:1,class:"text-gray-400 text-center mt-20"},le=e.defineComponent({__name:"RSS",setup(l){const n=()=>$tw.wiki.deleteTiddler("$:/layout");async function a(o){try{const{origin:t,hostname:s}=new URL(o),d=`${t}/favicon.ico`,g=await fetch(d);if(!g.ok)return"";const u=await g.blob();return await new Promise((_,y)=>{const b=new FileReader;b.onloadend=()=>_(b.result),b.onerror=y,b.readAsDataURL(u)})}catch{return P}}const m=e.ref(""),r=e.ref(""),i=e.ref([]),p=e.computed(()=>i.value.filter(o=>o.name.toLowerCase().includes(m.value.toLowerCase()))),v=e.ref(null),k=e.computed(()=>{const o=i.value.find(t=>t.name===v.value);return o?o.articles:[]}),f=e.ref(null);async function c(o){var s;if(!o.url)return;let t=o.url;if(window!=null&&window.electronAPI&&(t=await((s=window.electronAPI)==null?void 0:s.startFetchRSSData({url:o.url}))),!(o.articles&&o.articles.length>0))try{const{channel:d,items:g}=await E(t);o.articles=g.map((u,_)=>{var y;return{id:_,title:u.title,summary:((y=u.summary)==null?void 0:y.replace(/<[^>]+>/g,"").slice(0,100))||"",author:d.title||"",date:u.pubDate||"",content:u.summary||"",link:u.link,src:u.src,mp3:u.mp3}}),o.count=o.articles.length}catch{o.articles=[],o.count=0}}async function h(o){v.value=o;const t=i.value.find(s=>s.name===o);t&&((!t.articles||t.articles.length===0)&&await c(t),f.value=t.articles&&t.articles.length>0?t.articles[0]:null)}function w(o){f.value=o}async function x(){const o=r.value.trim();if(!o)return;let t=new URL(o).hostname;if(i.value.some(g=>g.url===o||g.name===t)){r.value="";return}const s=await a(o),d={name:t,url:o,count:0,articles:[],favicon:s};i.value.push(d),v.value=t,r.value="",await c(d),f.value=d.articles&&d.articles.length>0?d.articles[0]:null}return e.onMounted(async()=>{for(const o of z.filter(t=>t.startsWith("http"))){let t=new URL(o).hostname;i.value.push({name:t,url:o,count:0,articles:[],favicon:""})}i.value.length>0&&h(i.value[0].name),i.value.forEach(async o=>{const t=await a(o.url);o.favicon=t})}),(o,t)=>(e.openBlock(),e.createElementBlock("div",j,[e.createElementVNode("div",H,[e.createElementVNode("div",O,[e.createElementVNode("h2",W,[t[2]||(t[2]=e.createTextVNode(" Feeds ")),e.createVNode(e.unref($),{class:"size-4"})])]),e.createElementVNode("div",G,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>m.value=s),type:"text",placeholder:"Search feeds...",class:"outline-gray-400 border w-full p-2"},null,512),[[e.vModelText,m.value]])]),e.createElementVNode("div",J,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>r.value=s),type:"text",placeholder:"Add RSS URL",class:"p-2 border outline-gray-400 placeholder:text-gray-400"},null,512),[[e.vModelText,r.value]]),e.createElementVNode("button",{class:"flex items-center",onClick:x,disabled:!r.value.trim()},t[3]||(t[3]=[e.createElementVNode("i",{class:"i-[material-symbols--add-rounded]"},null,-1),e.createTextVNode(" Add ")]),8,K)]),e.createElementVNode("div",Q,[t[4]||(t[4]=e.createElementVNode("div",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 mb-2"}," My Feeds ",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,s=>(e.openBlock(),e.createElementBlock("div",{key:s.name,class:"flex items-center group gap-1"},[e.createElementVNode("div",X,[e.createVNode(R,{feed:s,selected:v.value===s.name,onLoad:d=>h(s.name)},null,8,["feed","selected","onLoad"])])]))),128)),e.createElementVNode("div",Y,[e.createVNode(e.unref(L),{class:"cursor-pointer text-gray-500",onClick:n})])])]),e.createElementVNode("div",Z,[t[5]||(t[5]=e.createElementVNode("h2",{class:"text-lg font-semibold mb-4 text-blue-700 drop-shadow"}," Articles ",-1)),e.createElementVNode("div",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(k.value,s=>(e.openBlock(),e.createBlock(I,{key:s.id,article:s,onClick:d=>w(s)},null,8,["article","onClick"]))),128))])]),e.createElementVNode("div",ee,[f.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h2",te,e.toDisplayString(f.value.title),1),e.createElementVNode("p",oe,e.toDisplayString(f.value.author)+", "+e.toDisplayString(f.value.date),1),e.createElementVNode("p",{innerHTML:f.value.content,class:"prose max-w-none"},null,8,ne)],64)):(e.openBlock(),e.createElementBlock("div",re,"暂无文章"))])]))}}),se={class:"vue-rss-plus-plugin"},ce=e.defineComponent({__name:"App",props:{title:{},theme:{},showLogos:{type:Boolean}},setup(l){return(n,a)=>(e.openBlock(),e.createElementBlock("div",se,[e.createVNode(le)]))}});function ae(l={}){return function(n={}){const a={...l,...n};return{render(){return e.h(ce,a)}}}}module.exports=ae;
