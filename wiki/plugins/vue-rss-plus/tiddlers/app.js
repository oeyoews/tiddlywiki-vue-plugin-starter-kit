"use strict";const e=window.Vue;async function _(s){let c;s.startsWith("http")?c=await(await fetch(s)).text():c=s;const i=new DOMParser().parseFromString(c,"text/xml"),l=(o,f)=>{var g,t;return((t=(g=o==null?void 0:o.getElementsByTagName(f))==null?void 0:g[0])==null?void 0:t.textContent)||""},h=o=>{var f;try{return((f=new DOMParser().parseFromString(o,"text/html").querySelector("img"))==null?void 0:f.src)||""}catch{return""}},d=i.querySelector("channel")||i,w=i.querySelectorAll("item, entry"),p={title:l(d,"title"),link:l(d,"link"),description:l(d,"description"),update:E(l(d,"lastBuildDate")||l(d,"pubDate")||l(d,"updated"))||""},x=[...w].map(o=>{var b;const f=l(o,"title"),g=l(o,"link"),t=l(o,"description")||"",n=l(o,"content:encoded")||l(o,"content")||"",r=l(o,"pubDate")||l(o,"updated")||"",u=t+n,v=((b=o.querySelector("enclosure"))==null?void 0:b.getAttribute("url"))||"",m=h(n||t);return{title:f,link:g,summary:u,pubDate:r,mp3:v,src:m}});return{channel:p,items:x}}function E(s){var c=new Date(s),a=new Date,i=Math.abs(a-c)/1e3,l={年:31536e3,月:2592e3,周:604800,天:86400,小时:3600,分钟:60,秒:1},h="";for(var d in l){var w=Math.floor(i/l[d]);if(w>0){h+=w+" "+d+"前";break}}return h}const V=["src"],N={class:"flex-1 text-left"},B={class:"text-xs text-gray-500 group-hover:text-gray-700"},D=e.defineComponent({__name:"FeedButton",props:{feed:Object,selected:Boolean},emits:["load"],setup(s){return(c,a)=>(e.openBlock(),e.createElementBlock("button",{class:e.normalizeClass(["bg-transparent w-full flex items-center px-3 py-2 text-sm text-gray-700 rounded border-none cursor-pointer hover:bg-gray-100 transition-colors group",s.selected?"bg-blue-100 font-bold":""]),onClick:a[0]||(a[0]=i=>c.$emit("load"))},[e.createElementVNode("img",{src:s.feed.favicon,class:"size-4 rounded-full mr-1"},null,8,V),e.createElementVNode("span",N,e.toDisplayString(s.feed.name),1),e.createElementVNode("span",B,e.toDisplayString(s.feed.count),1)],2))}}),S={class:"font-semibold"},F={class:"text-sm text-gray-600"},L={__name:"ArticleCard",props:{article:Object},setup(s){return(c,a)=>(e.openBlock(),e.createElementBlock("div",{class:"bg-white p-3 mb-3 rounded shadow cursor-pointer hover:bg-blue-50",onClick:a[0]||(a[0]=i=>c.$emit("click"))},[e.createElementVNode("h3",S,e.toDisplayString(s.article.title),1),e.createElementVNode("p",F,e.toDisplayString(s.article.summary),1)]))}},$=["https://www.freecodecamp.org/news/rss/","https://dev.to/feed","https://talk.tiddlywiki.org/posts.rss"],C="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='1em'%20height='1em'%20viewBox='0%200%2024%2024'%3e%3cpath%20fill='currentColor'%20d='m12%200l10.23%206v12L12%2024L1.77%2018V6zm3.961%2017.889l.154-.02c.113-.043.22-.081.288-.19c.227-.329-.357-.462-.566-.827c-.209-.364-1.071-2.364-.418-2.924s1.359-.79%201.629-1.315c.117-.236.238-.475.269-.742c.159.132.283.255.497.262c.567.036%201.054-.658%201.307-1.315c.135-.404.244-.832.218-1.226c-.069-.76.013-1.582.62-2.087c-.599.302-1.167.69-1.845.789c-.374-.114-.75-.216-1.147-.2c-.194-.253-.456-.727-.797-.782c-.58.208-.597%201.105-.842%202.321a5.351%205.351%200%200%200-1.154-.193c-.54-.035-1.42.134-2.038.116c-.619-.018-1.836-.562-2.849-.445c-.407.05-.817.12-1.195.291c-.231.105-.565.421-.733.468c-1.69.473-4.442.453-3.879-2.102c.044-.196.056-.373-.03-.417c-.11-.055-.17.06-.234.187c-.985%202.138.764%203.514%202.752%203.52c.625-.048.324-.007.904-.118l-.015.082a1.87%201.87%200%200%200%20.865%201.718c-.27.771-.805%201.389-1.173%202.097c.138.881%201.031%202.057%201.4%202.225c.326.147%201.036.149%201.2-.089c.059-.111.02-.351-.044-.474c.277.308.651.736%201.013.942c.217.104.434.17.677.18l.31-.016c.154-.033.336-.058.44-.195c.116-.2.007-.756-.476-.796c-.483-.04-.795-.222-1.24-.882c-.365-.638.077-1.517.226-2.145c.765.123%201.535.22%202.31.222c.336-.017.67-.03%201.001-.093c.106.27.402%201.025.404%201.239c.007.601-.219%201.205-.121%201.807c.06.177.005.512.35.526l.388.018l.267-.008c.341.573.637.572%201.307.591m-7.518-1.66l-.063-.056c-.184-.198-.66-.544-.572-.865c.075-.238.213-.457.323-.683l-.004.023c-.02.282-.059.56.032.837c.278.228.663.59.918.837c-.138-.038-.4-.117-.53-.066l-.104-.026z'/%3e%3c/svg%3e",A={class:"flex h-screen bg-gradient-to-tr from-blue-50 via-white to-purple-100"},M={class:"w-64 p-4 bg-white/80 backdrop-blur-md border-r border-blue-100"},T={class:"mb-4 flex"},U={class:"flex mb-4 justify-between"},R=["disabled"],P={class:"space-y-1"},j={class:"flex-1 min-w-0"},q={class:"flex-1 overflow-y-auto p-6 bg-white/60 backdrop-blur-lg rounded-xl mx-4 shadow-lg border border-blue-50"},z={class:"w-1/2 overflow-y-auto bg-white/80 backdrop-blur-lg p-8 shadow-2xl rounded"},I={class:"text-2xl font-bold mb-4 text-purple-700 drop-shadow"},O={class:"text-sm text-gray-500 mb-4"},H=["innerHTML"],W={key:1,class:"text-gray-400 text-center mt-20"},G=e.defineComponent({__name:"RSS",setup(s){async function c(t){try{const{origin:n,hostname:r}=new URL(t),u=`${n}/favicon.ico`,v=await fetch(u);if(!v.ok)return"";const m=await v.blob();return await new Promise((b,y)=>{const k=new FileReader;k.onloadend=()=>b(k.result),k.onerror=y,k.readAsDataURL(m)})}catch{return C}}const a=e.ref(""),i=e.ref(""),l=e.ref([]),h=e.computed(()=>l.value.filter(t=>t.name.toLowerCase().includes(a.value.toLowerCase()))),d=e.ref(null),w=e.computed(()=>{const t=l.value.find(n=>n.name===d.value);return t?t.articles:[]}),p=e.ref(null);async function x(t){var r;if(!t.url)return;let n=t.url;if(window!=null&&window.electronAPI&&(n=await((r=window.electronAPI)==null?void 0:r.startFetchRSSData({url:t.url}))),!(t.articles&&t.articles.length>0))try{const{channel:u,items:v}=await _(n);t.articles=v.map((m,b)=>{var y;return{id:b,title:m.title,summary:((y=m.summary)==null?void 0:y.replace(/<[^>]+>/g,"").slice(0,100))||"",author:u.title||"",date:m.pubDate||"",content:m.summary||"",link:m.link,src:m.src,mp3:m.mp3}}),t.count=t.articles.length}catch{t.articles=[],t.count=0}}async function o(t){d.value=t;const n=l.value.find(r=>r.name===t);n&&((!n.articles||n.articles.length===0)&&await x(n),p.value=n.articles&&n.articles.length>0?n.articles[0]:null)}function f(t){p.value=t}async function g(){const t=i.value.trim();if(!t)return;let n=new URL(t).hostname;if(l.value.some(v=>v.url===t||v.name===n)){i.value="";return}const r=await c(t),u={name:n,url:t,count:0,articles:[],favicon:r};l.value.push(u),d.value=n,i.value="",await x(u),p.value=u.articles&&u.articles.length>0?u.articles[0]:null}return e.onMounted(async()=>{for(const t of $.filter(n=>n.startsWith("http"))){let n=new URL(t).hostname;l.value.push({name:n,url:t,count:0,articles:[],favicon:""})}l.value.length>0&&o(l.value[0].name),l.value.forEach(async t=>{const n=await c(t.url);t.favicon=n})}),(t,n)=>(e.openBlock(),e.createElementBlock("div",A,[e.createElementVNode("div",M,[n[4]||(n[4]=e.createElementVNode("div",{class:"flex items-center justify-between mb-6"},[e.createElementVNode("h2",{class:"text-lg font-semibold text-gray-800 flex items-center gap-2"},[e.createTextVNode(" Feeds "),e.createElementVNode("i",{class:"i-[vscode-icons--file-type-rss] text-orange-400 animate-pulse"})])],-1)),e.createElementVNode("div",T,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":n[0]||(n[0]=r=>a.value=r),type:"text",placeholder:"Search feeds...",class:"outline-gray-400 border w-full p-2"},null,512),[[e.vModelText,a.value]])]),e.createElementVNode("div",U,[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":n[1]||(n[1]=r=>i.value=r),type:"text",placeholder:"Add RSS URL",class:"p-2 border outline-gray-400 placeholder:text-gray-400"},null,512),[[e.vModelText,i.value]]),e.createElementVNode("button",{class:"flex items-center",onClick:g,disabled:!i.value.trim()},n[2]||(n[2]=[e.createElementVNode("i",{class:"i-[material-symbols--add-rounded]"},null,-1),e.createTextVNode(" Add ")]),8,R)]),e.createElementVNode("div",P,[n[3]||(n[3]=e.createElementVNode("div",{class:"text-xs font-semibold text-gray-500 uppercase tracking-wider px-3 mb-2"}," My Feeds ",-1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(h.value,r=>(e.openBlock(),e.createElementBlock("div",{key:r.name,class:"flex items-center group gap-1"},[e.createElementVNode("div",j,[e.createVNode(D,{feed:r,selected:d.value===r.name,onLoad:u=>o(r.name)},null,8,["feed","selected","onLoad"])])]))),128))])]),e.createElementVNode("div",q,[n[5]||(n[5]=e.createElementVNode("h2",{class:"text-lg font-semibold mb-4 text-blue-700 drop-shadow"}," Articles ",-1)),e.createElementVNode("div",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(w.value,r=>(e.openBlock(),e.createBlock(L,{key:r.id,article:r,onClick:u=>f(r)},null,8,["article","onClick"]))),128))])]),e.createElementVNode("div",z,[p.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("h2",I,e.toDisplayString(p.value.title),1),e.createElementVNode("p",O,e.toDisplayString(p.value.author)+", "+e.toDisplayString(p.value.date),1),e.createElementVNode("p",{innerHTML:p.value.content,class:"prose max-w-none"},null,8,H)],64)):(e.openBlock(),e.createElementBlock("div",W,"暂无文章"))])]))}}),J={class:"vue-rss-plus-plugin"},K=e.defineComponent({__name:"App",props:{title:{},theme:{},showLogos:{type:Boolean}},setup(s){return(c,a)=>(e.openBlock(),e.createElementBlock("div",J,[e.createVNode(G)]))}});function Q(s={}){return function(c={}){const a={...s,...c};return{render(){return e.h(K,a)}}}}module.exports=Q;
